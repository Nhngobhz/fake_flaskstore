{% extends "base.html" %}
{% block content %}

<div id="app" class="container my-5">
    <h2 class="mb-4">Your Cart</h2>
    <div class="table-responsive">
        <table class="table table-bordered table-hover">
            <thead class="thead-dark">
                <tr>
                    <th scope="col">Product</th>
                    <th scope="col">Price</th>
                    <th scope="col">Quantity</th>
                    <th scope="col">Total</th>
                    <th scope="col">Action</th>
                </tr>
            </thead>
            <tbody>
                <tr v-for="(item, index) in cart_list" :key="'cart-item-' + index">
                    <td>
                        <div class="d-flex align-items-center">
                            <img :src="'/static/products/' + item.image" style="width: 50px; height: 50px; object-fit: cover;"
                                class="mr-3 rounded" alt="Product">
                            <span>[[ item.title.length > 20 ? item.title.slice(0, 30) + '...' : item.title ]]
                            </span>
                        </div>
                    </td>
                    <td>$[[item.price]]</td>
                    <td>
                        <div class="btn btn-sm btn-outline-danger btn-group btn-group-lg" role="group"
                            style="margin-right: 5px;" @click="minusQty(index)">-</div>

                        <div style="display:inline-block; width: 30px; text-align: center;">
                            [[ item.quantity ]]
                        </div>

                        <div class="btn btn-sm btn-outline-primary btn-group btn-group-lg" role="group"
                            style="margin-left: 5px;" @click="addQty(index)">+</div>

                    </td>
                    <td>

                        $[[ formatPrice(item.price * item.quantity) ]]


                    </td>
                    <td>
                        <button @click="removeFromCart(index)" class="btn btn-danger btn-sm">Remove</button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="d-flex justify-content-end">
        <div class="card p-3 shadow-sm" style="width: 300px;">
            <h5>Cart Summary</h5>
            <p class="mb-1">Subtotal: <strong>$[[ getTotal() ]]</strong></p>
            <p class="mb-1">Shipping: <strong>$5.00</strong></p>
            <hr>
            <p class="mb-1">Total: <strong>$[[ getTotalWithShipping() ]]</strong></p>
            <a class="btn btn-success btn-block mt-3" :class="{ disabled: cart_list.length === 0 }"
                :href="cart_list.length === 0 ? '#' : '/checkout'" @click="handleCheckout">
                Checkout
            </a>
        </div>
    </div>
</div>


{% endblock %}


<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>